---
name: "galaxy42-linux"
sudo: true
enable_cache: true
suites:
- "xenial"
architectures:
- "amd64"
packages:
- "gcc-5"
- "g++-5"
- "cmake"
- "autoconf"
- "libtool"
- "build-essential"
- "libfftw3-dev"
- "libsodium-dev"
- "libboost-system-dev"
- "libboost-filesystem-dev"
- "libboost-program-options-dev"
- "ca-certificates"  #  because of: Problem with the SSL CA cert (path? access rights?)
- "faketime" # used to force date
reference_datetime: "2011-01-30 00:00:00"
remotes:
- "dir": "galaxy42"
  "url": "https://github.com/damianbb/galaxy42.git"
  "commit": "1e7878d85520f3c34e1679a3541909fc249c531c" # um, update that in one more commit, can't commit own commit hash :)
# this is temporary, TODO, in the end use branch name / tag name
files: []
script: |
  export LD_PRELOAD=/usr/lib/x86_64-linux-gnu/faketime/libfaketime.so.1
  export FAKETIME=$REFERENCE_DATETIME
  echo "FAKETIME = ${FAKETIME}" # debug
  GALAXY_DIR=$(pwd)/galaxy42
  cd ${GALAXY_DIR}
  # cd share/script/install-as-root/ && sudo ./install -y
  cd ${GALAXY_DIR}
  echo -e "\n\n\n--------------------\nBuilding (we are inside Gitian) at date:\n"
  date
  COVERAGE=0 EXTLEVEL=0  ./do --go
  date
